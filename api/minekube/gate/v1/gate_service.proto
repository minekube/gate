syntax = "proto3";

package minekube.gate.v1;

// GateService is the service of a Gate instance.
service GateService {
  // GetPlayer returns the player by the given id or username.
  // If the player is not online, the rpc fails with a NOT_FOUND error code.
  rpc GetPlayer(GetPlayerRequest) returns (GetPlayerResponse);
  // ListServers returns all registered servers.
  rpc ListServers(ListServersRequest) returns (ListServersResponse);
  // AddServer adds a server to the proxy, will fail if server is already registered.
  rpc AddServer(AddServerRequest) returns (GetServerResponse);
  // RemoveServer removes a server from the proxy using the name and address of the server.
  rpc RemoveServer(RemoveServerRequest) returns (RemoveServerResponse);
}

message RemoveServerRequest {
  string name = 1;
  string address = 2;
}

message RemoveServerResponse {
  ServerRemoval server = 1;
}

message ServerRemoval {
  string name = 1;
  string address = 2;
}

message AddServerRequest {
  string name = 1;
  string address = 2;
}

message GetServerResponse {
  ServerAddition server = 1;
}

message ServerAddition {
  string name = 1;
  string address = 2;
}

// ListServersRequest is the request for ListServers method.
message ListServersRequest {
}
// ListServersResponse is the response for ListServers method.
message ListServersResponse {
  repeated Server servers = 1;
}

// Server is a backend server where Gate can connect players to.
message Server {
  string name = 1;
  string address = 2;
  int32 players = 3;
}

// GetPlayerRequest is the request for GetPlayer method.
message GetPlayerRequest {
  // Gets the player by the given id (Minecraft UUID).
  // Optional, if not set the username will be used.
  // If both id and username are set, the id will be used.
  //
  // Format but be a valid Minecraft UUID.
  string id = 1;
  // Gets the player by the given username.
  // Optional, if not set the id will be used.
  string username = 2;
}

// GetPlayerResponse is the response for GetPlayer method.
message GetPlayerResponse {
  // The player matching the request.
  Player player = 1;
}

// Player is a Gate player.
message Player {
  string id = 1;
  string username = 2;
}
